@{
    Layout = "_Root.Head";
}
@await Component.InvokeAsync("Widget", new { widgetZone = PublicWidgetZones.BodyStartHtmlTagAfter })
@await Html.PartialAsync("_Notifications")
@await Html.PartialAsync("_JavaScriptDisabledWarning")
@await Html.PartialAsync("_OldInternetExplorerWarning")
<div class="master-wrapper-page">
    @await Component.InvokeAsync("AdminHeaderLinks")
    <div class="exchange">
        <div class="container">
            <div class="exchange__body">
                <div class="exchange__marquee" style="overflow-wrap: normal; white-space: nowrap; overflow: hidden;">
                    <div class="exchange-line">
                        <span class="exchange__title">
                            Биржевые индексы:
                        </span>
                        <ul class="exchange__list">
                            <li class="exchange__item">
                                Золото: <span class="exchange__val" id="gold-span_1">--</span>
                                <span class="exchange__item-arrow exchange__item-arrow-gold" id="gold-span-arrow-1"></span>
                            </li>
                            <li class="exchange__item">
                                Серебро: <span class="exchange__val" id="silver-span_1">--</span>
                                <span class="exchange__item-arrow exchange__item-arrow-silver" id="silver-span-arrow-1"></span>
                            </li>
                            <li class="exchange__item">
                                Платина: <span class="exchange__val" id="platinum-span_1">--</span>
                                <span class="exchange__item-arrow exchange__item-arrow-platinum" id="platinum-span-arrow-1"></span>
                            </li>
                            <li class="exchange__item">
                                Доллар: <span class="exchange__val" id="usd-span_1">--</span>
                                <span class="exchange__item-arrow exchange__item-arrow-usd" id="usd-span-arrow-1"></span>
                            </li>
                            <li class="exchange__item">
                                Евро: <span class="exchange__val" id="eur-span_1">--</span>
                                <span class="exchange__item-arrow exchange__item-arrow-eur" id="eur-span-arrow-1"></span>
                            </li>
                        </ul>
                    </div>
                    <div class="exchange-line">
                        <span class="exchange__title">
                            Биржевые индексы:
                        </span>
                        <ul class="exchange__list">
                            <li class="exchange__item">
                                Золото: <span class="exchange__val" id="gold-span_2">--</span>
                                <span class="exchange__item-arrow exchange__item-arrow-gold" id="gold-span-arrow-2"></span>
                            </li>
                            <li class="exchange__item">
                                Серебро: <span class="exchange__val" id="silver-span_2">--</span>
                                <span class="exchange__item-arrow exchange__item-arrow-silver" id="silver-span-arrow-2"></span>
                            </li>
                            <li class="exchange__item">
                                Платина: <span class="exchange__val" id="platinum-span_2">--</span>
                                <span class="exchange__item-arrow exchange__item-arrow-platinum" id="platinum-span-arrow-2"></span>
                            </li>
                            <li class="exchange__item">
                                Доллар: <span class="exchange__val" id="usd-span_2">--</span>
                                <span class="exchange__item-arrow exchange__item-arrow-usd" id="usd-span-arrow-2"></span>
                            </li>
                            <li class="exchange__item">
                                Евро: <span class="exchange__val" id="eur-span_2">--</span>
                                <span class="exchange__item-arrow exchange__item-arrow-eur" id="eur-span-arrow-2"></span>
                            </li>
                        </ul>
                    </div>
                    <div class="exchange-line">
                        <span class="exchange__title">
                            Биржевые индексы:
                        </span>
                        <ul class="exchange__list">
                            <li class="exchange__item">
                                Золото: <span class="exchange__val" id="gold-span_3">--</span>
                                <span class="exchange__item-arrow exchange__item-arrow-gold" id="gold-span-arrow-3"></span>
                            </li>
                            <li class="exchange__item">
                                Серебро: <span class="exchange__val" id="silver-span_3">--</span>
                                <span class="exchange__item-arrow exchange__item-arrow-silver" id="silver-span-arrow-3"></span>
                            </li>
                            <li class="exchange__item">
                                Платина: <span class="exchange__val" id="platinum-span_3">--</span>
                                <span class="exchange__item-arrow exchange__item-arrow-platinum" id="platinum-span-arrow-3"></span>
                            </li>
                            <li class="exchange__item">
                                Доллар: <span class="exchange__val" id="usd-span_3">--</span>
                                <span class="exchange__item-arrow exchange__item-arrow-usd" id="usd-span-arrow-3"></span>
                            </li>
                            <li class="exchange__item">
                                Евро: <span class="exchange__val" id="eur-span_3">--</span>
                                <span class="exchange__item-arrow exchange__item-arrow-eur" id="eur-span-arrow-3"></span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div><!-- /.exchange -->
    <script asp-location="Footer">
        function loadTicker() {
            const settings = {
                "async": true,
                "crossDomain": true,
                "url": 'https://web-api.online/api/Currencies/Ticker',
                "method": "GET"
            };

            $.ajax(settings).done(function (response) {
                $("#gold-span_1").text('$ ' + response[2].buy);
                $("#gold-span_2").text('$ ' + response[2].buy);
                $("#gold-span_3").text('$ ' + response[2].buy);


                $("#silver-span_1").text('$ ' + response[4].buy);
                $("#silver-span_2").text('$ ' + response[4].buy);
                $("#silver-span_3").text('$ ' + response[4].buy);

                $("#platinum-span_2").text('$ ' + response[3].buy);
                $("#platinum-span_1").text('$ ' + response[3].buy);
                $("#platinum-span_3").text('$ ' + response[3].buy);

                $("#usd-span_1").html(response[0].buy + " руб.");
                $("#usd-span_2").html(response[0].buy + " руб.");
                $("#usd-span_3").html(response[0].buy + " руб.");

                $("#eur-span_1").html(response[1].buy + " руб.");
                $("#eur-span_2").html(response[1].buy + " руб.");
                $("#eur-span_3").html(response[1].buy + " руб.");

                var usd_arrow = response.find(x => x.acronim == "USD").isUp;
                var eur_arrow = response.find(x => x.acronim == "EUR").isUp;
                var xau_arrow = response.find(x => x.acronim == "XAU").isUp;
                var pl_arrow = response.find(x => x.acronim == "PL").isUp;
                var xag_arrow = response.find(x => x.acronim == "XAG").isUp;

                function tickerArrow(str) {
                    if (str == true) {
                        return "↑";
                    }
                    if (str == false) {
                        return "↓";
                    }
                    if (str == null) {
                        return " ";
                    }
                }

                $(".exchange__item-arrow-gold").html(tickerArrow(xau_arrow));
                $(".exchange__item-arrow-eur").html(tickerArrow(eur_arrow));
                $(".exchange__item-arrow-platinum").html(tickerArrow(pl_arrow));
                $(".exchange__item-arrow-usd").html(tickerArrow(usd_arrow));
                $(".exchange__item-arrow-silver").html(tickerArrow(xag_arrow));

            });
        }

        $(document).ready(function () {
            loadTicker();
        });

    </script>
    @await Html.PartialAsync("_Header")
    <script asp-location="Footer">
        var localized_data = {
            AjaxCartFailure: "@T("AjaxCart.Failure")"
        };
        AjaxCart.init(false, '.header-links .cart-qty', '.header-links .wishlist-qty', '#flyout-cart', localized_data);
    </script>
    <div class="header-menu">
        @await Component.InvokeAsync("TopMenu")
    </div>
    <div class="master-wrapper-content">
        @await Component.InvokeAsync("Widget", new { widgetZone = PublicWidgetZones.ContentBefore })

        @if (IsSectionDefined("Breadcrumb"))
        {
            @RenderSection("Breadcrumb")
        }
        <div class="master-column-wrapper">
            @RenderBody()
        </div>
        @await Component.InvokeAsync("Widget", new { widgetZone = PublicWidgetZones.ContentAfter })
    </div>
    @await Component.InvokeAsync("Footer")
</div>
@await Component.InvokeAsync("EuCookieLaw")
@await Component.InvokeAsync("Widget", new { widgetZone = PublicWidgetZones.BodyEndHtmlTagBefore })
